// Create a new port in a component
with [get-palette] {
   with [get-palette-entry Port] {
       mouse-move 33 16 button1 -height 23 -width 339
       mouse-press 33 16 button1 -height 23 -width 339
       mouse-release 33 16 button1 524288 -height 23 -width 339
    }
}
with [get-diagram -index 1 | get-edit-part -name "NewModel Composite Structure Diagram"] {
   with [get-edit-part -name Component2 | get-edit-part 
      -className DNodeContainerViewNodeContainerCompartmentEditPart] {
       mouse-move 47 34 button1 -height 98 -width 118
       mouse-press 47 34 button1 -height 98 -width 118
       mouse-release 47 34 button1 524288 -height 98 -width 118
   }
}

// Check Diagram
get-editor "NewModel Composite Structure Diagram" | get-diagram -index 1 | get-edit-part 
    -name "NewModel Composite Structure Diagram" | get-edit-part -name Component2 | get-edit-part -name port1 
with [get-editor "NewModel Composite Structure Diagram" | get-diagram -index 1 | get-edit-part 
    -name "NewModel Composite Structure Diagram" | get-edit-part -name Component2 | get-edit-part -name port1 
    | get-edit-part -name port1] {
    get-property "element.target.owner.name" | equals Component2 | verify-true
    get-property "element.target.name" | equals port1 | verify-true
}