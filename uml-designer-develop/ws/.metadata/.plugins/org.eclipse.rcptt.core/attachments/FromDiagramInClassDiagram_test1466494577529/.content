// Copy class Agency (ctrl-c)
with [get-editor Entities] {
    with [get-diagram -index 1] {
        with [get-edit-part -name Entities | get-edit-part -name Agency] {
            mouse-press 159 22 button1 -height 63 -width 183
            mouse-hover 159 22 -height 63 -width 183
        }
        key-type "M1+c"
        
//Paste Class Agency,  click at the paste position and ctrl-v
        with [get-edit-part -name Entities] {
            mouse-move 698 71 button1 -height 698 -width 953
            mouse-press 698 71 button1 -height 698 -width 953
            mouse-release 698 71 button1 524288 -height 698 -width 953
        }
        key-type "M1+v"
    }
}

//Check new element appears in diagram
get-editor Entities | get-diagram -index 1 | get-edit-part -name Entities | get-edit-part -name Agency -index 1 
    | get-edit-part -className DNodeListNameEditPart | get-property "getFigure().getText()" | equals Agency 
    | verify-true
get-editor Entities | get-diagram -index 1 | get-edit-part -name Entities | get-edit-part -name Agency -index 1 
    | get-edit-part -className DNodeListViewNodeListCompartment2EditPart | get-edit-part -name "name : String [1]" 
    | get-property "getFigure().getText()" | equals "name : String [1]" | verify-true
with [get-editor Entities | get-diagram -index 1 | get-edit-part -name Entities | get-edit-part -name Agency -index 1] {
}
    
//Check element to copy is always present in diagram    
get-editor Entities | get-diagram -index 1 | get-edit-part -name Entities | get-edit-part -name Agency | get-edit-part 
    -className DNodeListNameEditPart | get-property "getFigure().getText()" | equals Agency | verify-true
with [get-editor Entities | get-diagram -index 1 | get-edit-part -name Entities|get-edit-part -name Agency] {
}

// Check element in model
with [get-editor Entities | get-diagram -index 1 | get-edit-part -name Entities] {
    with [get-edit-part -name Agency -index 1] {
        get-property "element.target.name" | equals Agency | verify-true
        //get-property "element.target.nameExpression" | equals null | verify-true
        get-property "element.target.qualifiedName" | equals "Travel Agency::Agency" | verify-true
        get-property "element.target.visibility" | equals public | verify-true
        get-property "element.target.isLeaf" | equals false | verify-true
        //get-property "element.target.owningTemplateParameter" | equals null | verify-true
        //get-property "element.target.templateParameter" | equals null | verify-true
        //get-property "element.target.ownedTemplateSignature" | equals null | verify-true
        get-property "element.target.isAbstract" | equals false | verify-true
        get-property "element.target.isFinalSpecialization" | equals false | verify-true
        //get-property "element.target.representation" | equals null | verify-true
        //get-property "element.target.classifierBehavior" | equals null | verify-true
        get-property "element.target.isActive" | equals false | verify-true
    }
    
// Check previous existing element
    with [get-edit-part -name Agency] {
        get-property "element.target.name" | equals Agency | verify-true
        //get-property "element.target.nameExpression" | equals null | verify-true
        get-property "element.target.qualifiedName" | equals "Travel Agency::Components::Agency  Offers::Agency" 
            | verify-true
        get-property "element.target.visibility" | equals public | verify-true
        get-property "element.target.isLeaf" | equals false | verify-true
        //get-property "element.target.owningTemplateParameter" | equals null | verify-true
        //get-property "element.target.templateParameter" | equals null | verify-true
        //get-property "element.target.package" | equals null | verify-true
        //get-property "element.target.ownedTemplateSignature" | equals null | verify-true
        get-property "element.target.isAbstract" | equals false | verify-true
        get-property "element.target.isFinalSpecialization" | equals false | verify-true
        //get-property "element.target.representation" | equals null | verify-true
        //get-property "element.target.classifierBehavior" | equals null | verify-true
        get-property "element.target.isActive" | equals false | verify-true
    }
}